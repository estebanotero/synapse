{
	"name": "Creo tablas para Apuestas_Deportivas",
	"properties": {
		"folder": {
			"name": "bplay"
		},
		"content": {
			"query": "/* Puede crear tablas utlizando los arquivos Parquet en un datalake \"desarrollo\" */\n\n--Drop external table [dw].[calendario]\nCREATE EXTERNAL TABLE [dw].[calendario]\nWITH\n\t(LOCATION = 'Synapse/Calendario',\n    DATA_SOURCE = desarrollo,\n    FILE_FORMAT = PARQUET)\nAS\n\nSelect \n    Cast(DateID as bigint) as DateID,\n\tCalendarDate,\n\tPeriodo,\n\t[Year],\n\t[Month],\n\t[Day],\n\t[Weekday],\n\tEjercicio_fiscal\nFROM \n    OPENROWSET(BULK 'https://storageaccdesarrollo.dfs.core.windows.net/filesystemdesarrollo/bplay/Calendario/**',\n                FORMAT = 'PARQUET') a\n\n--Drop external table [dw].[Dim_Coupon]\nCREATE EXTERNAL TABLE [dw].[Dim_Coupon]\nWITH\n\t(LOCATION = 'Synapse/Dim_Coupon',\n    DATA_SOURCE = desarrollo,\n    FILE_FORMAT = PARQUET)\nAS\n\nSELECT\n     [resolution_date]\n    ,[fecha_resolucion]\n    ,[hora_resolucion]\n    ,[coupon_id]\n    ,[coupon_size]\n    ,[live_betting]\n    ,[coupon_odds]\n    ,[coupon_stake]\n    ,[coupon_status_id]\n    ,[coupon_status]\n FROM \n    OPENROWSET(BULK 'https://storageaccdesarrollo.dfs.core.windows.net/filesystemdesarrollo/bplay/Dim_Coupon/**',\n                FORMAT = 'PARQUET') a\n\n--Drop external table [dw].[Dim_Event]\nCREATE EXTERNAL TABLE [dw].[Dim_Event]\nWITH\n\t(LOCATION = 'Synapse/Dim_Event',\n    DATA_SOURCE = desarrollo,\n    FILE_FORMAT = PARQUET)\nAS\n\nSELECT\n     [event_id]\n    ,[event_name]\n    ,[event_date]\n    ,[Fecha_Evento]\n    ,[Hora_Evento]\n    ,[sport]\n    ,[competition]\n    ,[region]\n    ,[provider_id]\n FROM \n    OPENROWSET(BULK 'https://storageaccdesarrollo.dfs.core.windows.net/filesystemdesarrollo/bplay/Dim_Event/**',\n                FORMAT = 'PARQUET') a\n\n--Drop external table [dw].[Dim_Player]\nCREATE EXTERNAL TABLE [dw].[Dim_Player]\nWITH\n\t(LOCATION = 'Synapse/Dim_Player',\n    DATA_SOURCE = desarrollo,\n    FILE_FORMAT = PARQUET)\nAS\n\nSELECT \n    [partner_id]\n    ,[Jurisdiccion]\n    ,[player_type_id]\n    ,[player_type]\n    ,[partner_player_id]\n    ,[player_id]\n    ,[dias_antiguedad]\n    ,[created_date]\n    ,[valido_desde]\n    ,[fecha_exclusion]\n    ,[fecha_registro]\n    ,[hora_registro]\n    ,[camada_registro]\n    ,[zip_code]\n    ,[player_city]\n    ,[partner_state_id]\n    ,[player_state]\n    ,[partner_country_id]\n    ,[player_country]\n    ,[rango_edad]\n    ,[DNI]\n    ,[sexo]\n    ,[email]\n    ,[phone]\n    ,[address]\n    ,[player_source_id]\n    ,[player_source]\n    ,[nombre]\n    ,[apellido]\n    ,[fecha_nacimiento]\n    ,[edad]\n    ,[player_alias]\n    ,[usuario]\n    ,[player_status_id]\n    ,[player_status]\n    ,[partner_affiliate_id]\n    ,[player_affiliate]\n    FROM \n    OPENROWSET(BULK 'https://storageaccdesarrollo.dfs.core.windows.net/filesystemdesarrollo/bplay/Dim_Player/**',\n                FORMAT = 'PARQUET') a\n\n--Drop external table [dw].[Fact_Coupon_Row]\nCREATE EXTERNAL TABLE [dw].[Fact_Coupon_Row]\nWITH\n\t(LOCATION = 'Synapse/Fact_Coupon_Row',\n    DATA_SOURCE = desarrollo,\n    FILE_FORMAT = PARQUET)\nAS\n\nSELECT\n    [created_date]\n    ,[fecha_apuesta]\n    ,[hora_apuesta]\n    ,[player_type_id]\n    ,Cast([partner_player_id] as BIGINT) as partner_player_id\n    ,[partner_id]\n    ,[balance_type_id]\n    ,[combination_status_id]\n    ,[combination_status]\n    ,[operation_type_id]\n    ,[room_id]\n    ,[provider_id]\n    ,[market]\n    ,[bet_offer_description]\n    ,[row_odds]\n    ,[combination_odds]\n    ,[combiantion_stake]\n    ,[row_amount]\n    ,[bet_type_id]\n    ,[bet_type]\n    ,[live_betting]\n    ,[coupon_channel]\n    ,[partner_event_id] \n    ,[event_id]\n    ,[player_id]\n    ,[partner_couponrow_id] \n    ,[coupon_row_id]\n    ,[coupon_id]\n    ,[row_id]\n    ,[bet_size]\nFROM \n    OPENROWSET(BULK 'https://storageaccdesarrollo.dfs.core.windows.net/filesystemdesarrollo/bplay/Fact_Coupon_Row/**',\n                FORMAT = 'PARQUET') a",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "serverless_Desarrollo",
				"poolName": "Built-in"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}